<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>JADWAL SPORT SLOTGOKIL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --accent: #1976d2;
      --accent-dark: #135ba1;
      --bg-main: #f7f7f7;
      --bg-card: #fff;
      --bg-accent: #f1f3f6;
      --bg-hover: #e3eaf3;
      --border: #d1d5db;
      --text-main: #222;
      --text-muted: #666;
      --tab-bg: #f1f3f6;
      --tab-active: #fff;
      --tab-border: #d1d5db;
      --radius: 14px;
    }
    body {
      background: var(--bg-main);
      color: var(--text-main);
      font-family: 'Segoe UI', Arial, Roboto, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      transition: background 0.3s, color 0.3s;
    }
    /* Welcome Screen */
    #welcome-screen {
      position: fixed;
      z-index: 9999;
      top: 0; left: 0; right: 0; bottom: 0;
      background: var(--bg-main);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      transition: opacity 0.5s;
    }
    .welcome-card {
      background: var(--bg-card);
      border-radius: 22px;
      box-shadow: 0 6px 32px rgba(25, 118, 210, 0.10), 0 1.5px 8px rgba(0,0,0,0.08);
      padding: 38px 32px 32px 32px;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 320px;
      max-width: 94vw;
      animation: fadeIn 0.7s cubic-bezier(.77,0,.18,1);
    }
    .welcome-logo {
      width: 180px;
      max-width: 80vw;
      margin-bottom: 28px;
      display: block;
    }
    .welcome-title {
      font-size: 2.1rem;
      font-weight: bold;
      color: var(--accent);
      text-align: center;
      margin-bottom: 28px;
      letter-spacing: 1px;
      font-family: 'Segoe UI', Arial, Roboto, sans-serif;
    }
    .welcome-btn {
      background: var(--accent);
      color: #fff;
      font-size: 1.25rem;
      font-weight: bold;
      border: none;
      border-radius: 12px;
      padding: 18px 38px;
      cursor: pointer;
      box-shadow: 0 2px 12px rgba(25,118,210,0.08);
      transition: background 0.2s, color 0.2s;
      margin-top: 12px;
      letter-spacing: 1px;
      text-align: center;
      outline: none;
    }
    .welcome-btn:hover, .welcome-btn:focus {
      background: var(--accent-dark);
      color: #fff;
    }
    @keyframes fadeIn {
      from { opacity: 0;}
      to { opacity: 1;}
    }
    /* Jadwal Sport Layout */
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 8px 32px 8px;
      display: none;
    }
    .header-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 0;
      padding: 18px 0 0 0;
    }
    .sports-tabs {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      border-bottom: 1px solid var(--border);
      padding-bottom: 8px;
      margin: 0;
      flex: 1;
    }
    .sport-btn {
      background: var(--tab-bg);
      border: 1px solid var(--tab-border);
      border-bottom: none;
      border-radius: 7px 7px 0 0;
      color: var(--text-main);
      font-size: 1rem;
      font-weight: 500;
      padding: 8px 18px;
      cursor: pointer;
      outline: none;
      transition: background 0.2s, color 0.2s;
      min-width: 80px;
      white-space: nowrap;
    }
    .sport-btn.active {
      background: var(--tab-active);
      color: var(--accent);
      font-weight: 600;
      border-bottom: 2px solid var(--accent);
    }
    .dark-toggle-btn {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      margin-left: 12px;
      color: var(--text-muted);
      transition: color 0.2s;
    }
    .dark-toggle-btn:hover {
      color: var(--accent);
    }
    .accordion {
      margin-bottom: 18px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--bg-card);
      overflow: hidden;
      transition: background 0.3s;
    }
    .accordion-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      padding: 14px 18px;
      background: var(--bg-accent);
      font-size: 1.08rem;
      font-weight: 600;
      border-bottom: 1px solid var(--border);
      user-select: none;
      transition: background 0.2s;
    }
    .accordion-header:hover, .accordion-header:active {
      background: var(--bg-hover);
    }
    .league-icon {
      font-size: 1.5rem;
      margin-right: 10px;
      flex-shrink: 0;
      display: inline-block;
      vertical-align: middle;
    }
    .accordion-title {
      font-weight: bold;
      color: var(--text-main);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .accordion-arrow {
      font-size: 1.2em;
      transition: transform 0.3s;
      margin-left: 10px;
      color: var(--text-muted);
    }
    .accordion.expanded .accordion-arrow {
      transform: rotate(90deg);
    }
    .accordion-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s cubic-bezier(.4,0,.2,1), padding 0.3s;
      background: var(--bg-card);
      padding: 0 18px;
    }
    .accordion.expanded .accordion-content {
      padding: 14px 18px 18px 18px;
      max-height: 1200px;
    }
    .league-table-wrap {
      width: 100%;
      overflow-x: auto;
    }
    table.league-table {
      width: 100%;
      border-collapse: collapse;
      background: var(--bg-card);
      font-size: 0.98rem;
      min-width: 420px;
    }
    table.league-table th, table.league-table td {
      padding: 8px 6px;
      text-align: center;
      border-bottom: 1px solid var(--border);
      font-weight: 400;
      color: var(--text-main);
    }
    table.league-table th {
      background: var(--bg-accent);
      font-weight: 600;
      color: var(--text-muted);
      font-size: 0.97rem;
      letter-spacing: 0.5px;
    }
    table.league-table tr {
      background: var(--bg-card);
      transition: background 0.2s;
    }
    table.league-table tr:hover {
      background: var(--bg-hover);
    }
    .bet-btn {
      background: var(--tab-bg);
      color: var(--accent);
      border: none;
      border-radius: 4px;
      padding: 6px 16px;
      font-size: 0.97rem;
      font-weight: 700;
      cursor: pointer;
      text-decoration: none;
      transition: background 0.2s, color 0.2s;
      display: inline-block;
    }
    .bet-btn:hover, .bet-btn:focus {
      background: var(--accent);
      color: #fff;
    }
    .error-msg {
      color: #d32f2f;
      background: #fff0f0;
      border: 1px solid #f5c2c7;
      border-radius: 6px;
      padding: 18px;
      text-align: center;
      margin: 32px 0;
      font-weight: 500;
    }
    .loader {
      text-align: center;
      color: var(--text-muted);
      padding: 32px 0;
      font-size: 1.1rem;
    }
    /* Dark mode */
    .dark-mode {
      --bg-main: #181a20;
      --bg-card: #23252b;
      --bg-accent: #23252b;
      --bg-hover: #222c36;
      --border: #333a45;
      --text-main: #fff;
      --text-muted: #b0b0b0;
      --accent: #90caf9;
      --accent-dark: #1976d2;
      --tab-bg: #23252b;
      --tab-active: #181a20;
      --tab-border: #333a45;
    }
    .dark-mode #welcome-screen {
      background: var(--bg-main);
    }
    .dark-mode .welcome-card {
      background: var(--bg-card);
      box-shadow: 0 6px 32px rgba(144,202,249,0.10), 0 1.5px 8px rgba(0,0,0,0.08);
    }
    .dark-mode .welcome-title {
      color: var(--accent);
    }
    .dark-mode .welcome-btn {
      background: var(--accent);
      color: #fff;
    }
    .dark-mode .welcome-btn:hover, .dark-mode .welcome-btn:focus {
      background: var(--accent-dark);
      color: #fff;
    }
    .dark-mode .error-msg {
      background: #2d1a1a;
      color: #ffb4b4;
      border-color: #a33;
    }
    .dark-mode .bet-btn {
      color: #90caf9;
      background: #263859;
    }
    .dark-mode .bet-btn:hover, .dark-mode .bet-btn:focus {
      background: #1976d2;
      color: #fff;
    }
    @media (max-width: 700px) {
      .container { max-width: 100vw; padding: 0 2px 24px 2px; }
      .sports-tabs { font-size: 0.97rem; gap: 4px; }
      .sport-btn { padding: 7px 10px; font-size: 0.97rem; min-width: 60px; }
      .accordion-header { font-size: 1rem; padding: 11px 10px; }
      .accordion-content { padding: 0 10px; }
      .accordion.expanded .accordion-content { padding: 10px 10px 14px 10px; }
      table.league-table th, table.league-table td { padding: 6px 2px; font-size: 0.95rem; }
      .bet-btn { padding: 5px 10px; font-size: 0.95rem; }
      .welcome-card { padding: 18px 8px 18px 8px; min-width: 0; }
      .welcome-logo { width: 120px; }
      .welcome-title { font-size: 1.1rem; margin-bottom: 18px; }
      .welcome-btn { font-size: 1rem; padding: 10px 18px; }
    }
    @media (max-width: 480px) {
      table.league-table { min-width: 320px; font-size: 0.93rem; }
      .league-table-wrap { padding: 0; }
    }
  </style>
</head>
<body>
  <!-- Welcome Screen -->
  <div id="welcome-screen">
    <div class="welcome-card">
      <img class="welcome-logo" src="https://i.ibb.co/ksD92H7L/sg-logo-200x90-20211713191713-2.png" alt="Logo Slotgokil">
      <div class="welcome-title">JADWAL SPORT SLOTGOKIL</div>
      <button class="welcome-btn" id="welcome-btn">LIHAT JADWAL SPORT</button>
    </div>
  </div>
  <!-- Jadwal Sport Container -->
  <div class="container">
    <div class="header-bar">
      <div class="sports-tabs" id="sports-tabs"></div>
      <button class="dark-toggle-btn" id="dark-toggle" title="Toggle dark mode">ð</button>
    </div>
    <div id="main-content"></div>
  </div>
  <script>
    // Ganti URL_API sesuai endpoint Anda
    const URL_API = 'https://script.google.com/macros/s/AKfycbzoIifvsbqAcfiVvBhNdYsUqSGpu2AwpD2CntfeTseVk8rKatfOJ9pXCH0e4Ox1U1hU-A/exec';

    // Kategori olahraga + emoji
    const SPORTS = [
      { key: 'bola', label: 'Bola', emoji: 'â½' },
      { key: 'basket', label: 'Basket', emoji: 'ð' },
      { key: 'tennis', label: 'Tennis', emoji: 'ð¾' },
      { key: 'voli', label: 'Voli', emoji: 'ð' },
      { key: 'badminton', label: 'Badminton', emoji: 'ð¸' },
      { key: 'baseball', label: 'Baseball', emoji: 'â¾' },
      { key: 'esport', label: 'Esports', emoji: 'ð®' }
    ];

    // Mapping emoji bendera negara super lengkap
    function getLigaIcon(liga) {
      if (!liga) return "ð";
      if (liga.includes("Argentina")) return "ð¦ð·";
      if (liga.includes("Brazil")) return "ð§ð·";
      if (liga.includes("Spain")) return "ðªð¸";
      if (liga.includes("Italy")) return "ð®ð¹";
      if (liga.includes("France")) return "ð«ð·";
      if (liga.includes("Germany")) return "ð©ðª";
      if (liga.includes("England") || liga.includes("Premier League")) return "ð´";
      if (liga.includes("USA") || liga.includes("NBA") || liga.includes("MLS")) return "ðºð¸";
      if (liga.includes("Japan")) return "ð¯ðµ";
      if (liga.includes("South Korea") || liga.includes("K League")) return "ð°ð·";
      if (liga.includes("Mexico")) return "ð²ð½";
      if (liga.includes("Netherlands")) return "ð³ð±";
      if (liga.includes("Belgium")) return "ð§ðª";
      if (liga.includes("Sweden")) return "ð¸ðª";
      if (liga.includes("Norway")) return "ð³ð´";
      if (liga.includes("Portugal")) return "ðµð¹";
      if (liga.includes("Turkey")) return "ð¹ð·";
      if (liga.includes("Russia")) return "ð·ðº";
      if (liga.includes("Greece")) return "ð¬ð·";
      if (liga.includes("Ukraine")) return "ðºð¦";
      if (liga.includes("Denmark")) return "ð©ð°";
      if (liga.includes("Poland")) return "ðµð±";
      if (liga.includes("Czech")) return "ð¨ð¿";
      if (liga.includes("Croatia")) return "ð­ð·";
      if (liga.includes("Serbia")) return "ð·ð¸";
      if (liga.includes("Switzerland")) return "ð¨ð­";
      if (liga.includes("Austria")) return "ð¦ð¹";
      if (liga.includes("Scotland")) return "ð´";
      if (liga.includes("Ireland")) return "ð®ðª";
      if (liga.includes("Australia")) return "ð¦ðº";
      if (liga.includes("New Zealand")) return "ð³ð¿";
      if (liga.includes("China")) return "ð¨ð³";
      if (liga.includes("Vietnam")) return "ð»ð³";
      if (liga.includes("Thailand")) return "ð¹ð­";
      if (liga.includes("Malaysia")) return "ð²ð¾";
      if (liga.includes("Indonesia")) return "ð®ð©";
      if (liga.includes("Philippines")) return "ðµð­";
      if (liga.includes("India")) return "ð®ð³";
      if (liga.includes("Singapore")) return "ð¸ð¬";
      if (liga.includes("Saudi Arabia")) return "ð¸ð¦";
      if (liga.includes("UAE") || liga.includes("Emirates")) return "ð¦ðª";
      if (liga.includes("Qatar")) return "ð¶ð¦";
      if (liga.includes("Kuwait")) return "ð°ð¼";
      if (liga.includes("Iran")) return "ð®ð·";
      if (liga.includes("Iraq")) return "ð®ð¶";
      if (liga.includes("Israel")) return "ð®ð±";
      if (liga.includes("Chile")) return "ð¨ð±";
      if (liga.includes("Colombia")) return "ð¨ð´";
      if (liga.includes("Peru")) return "ðµðª";
      if (liga.includes("Uruguay")) return "ðºð¾";
      if (liga.includes("Paraguay")) return "ðµð¾";
      if (liga.includes("Venezuela")) return "ð»ðª";
      if (liga.includes("Ecuador")) return "ðªð¨";
      if (liga.includes("Bolivia")) return "ð§ð´";
      if (liga.includes("Morocco")) return "ð²ð¦";
      if (liga.includes("Egypt")) return "ðªð¬";
      if (liga.includes("Algeria")) return "ð©ð¿";
      if (liga.includes("Nigeria")) return "ð³ð¬";
      if (liga.includes("Ghana")) return "ð¬ð­";
      if (liga.includes("Cameroon")) return "ð¨ð²";
      if (liga.includes("South Africa")) return "ð¿ð¦";
      // fallback
      return "ð";
    }

    // Escape HTML for safety
    function escapeHTML(str) {
      return String(str || '').replace(/[&<>"']/g, function(m) {
        return ({'&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'})[m];
      });
    }

    // Render tabs kategori olahraga
    function renderSportsTabs(activeSport) {
      const tabs = document.getElementById('sports-tabs');
      tabs.innerHTML = '';
      SPORTS.forEach(sport => {
        const btn = document.createElement('button');
        btn.className = 'sport-btn' + (sport.key === activeSport ? ' active' : '');
        btn.textContent = sport.emoji + ' ' + sport.label;
        btn.onclick = () => {
          if (window.currentSport !== sport.key) {
            window.currentSport = sport.key;
            renderSportsTabs(sport.key);
            fetchAndRenderLeagues(sport.key);
          }
        };
        tabs.appendChild(btn);
      });
    }

    // Loader
    function showLoader() {
      document.getElementById('main-content').innerHTML =
        '<div class="loader">Memuat jadwal...</div>';
    }

    // Error
    function showError(msg) {
      document.getElementById('main-content').innerHTML =
        `<div class="error-msg">${msg}</div>`;
    }

    // Render liga dan pertandingan
    function renderLeagues(ligaMap, sportKey) {
      const main = document.getElementById('main-content');
      main.innerHTML = '';
      if (!ligaMap || Object.keys(ligaMap).length === 0) {
        main.innerHTML = '<div class="error-msg">Tidak ada jadwal tersedia.</div>';
        return;
      }
      Object.entries(ligaMap).forEach(([liga, matches], idx) => {
        // Accordion
        const accordion = document.createElement('div');
        accordion.className = 'accordion' + (idx === 0 ? ' expanded' : '');

        // Header
        const header = document.createElement('div');
        header.className = 'accordion-header';
        header.innerHTML = `
          <span class="accordion-title">
            <span class="league-icon">${getLigaIcon(liga)}</span>
            <b>${escapeHTML(liga)}</b>
          </span>
          <span class="accordion-arrow">&#9654;</span>`;
        header.onclick = () => {
          accordion.classList.toggle('expanded');
        };

        // Content
        const content = document.createElement('div');
        content.className = 'accordion-content';

        // Table
        const tableWrap = document.createElement('div');
        tableWrap.className = 'league-table-wrap';
        const table = document.createElement('table');
        table.className = 'league-table';

        // Esport: cek jika sportKey === 'esport'
        let isEsport = sportKey === 'esport';

        // Table header
        table.innerHTML = `
          <thead>
            <tr>
              <th>Tanggal</th>
              <th>Jam</th>
              <th>Home</th>
              <th>Away</th>
              ${isEsport ? '<th>Skor</th>' : ''}
              <th>BET</th>
            </tr>
          </thead>
          <tbody>
            ${matches.map(m => `
              <tr>
                <td>${escapeHTML(m.tanggal)}</td>
                <td>${escapeHTML(m.jam)}</td>
                <td>${escapeHTML(isEsport ? m.tima : m.home)}</td>
                <td>${escapeHTML(isEsport ? m.timb : m.away)}</td>
                ${isEsport ? `<td>${escapeHTML(m.skor || '-')}</td>` : ''}
                <td>
                  <a class="bet-btn" href="${m.linkbet || '#'}" target="_blank" rel="noopener">BET</a>
                </td>
              </tr>
            `).join('')}
          </tbody>
        `;
        tableWrap.appendChild(table);
        content.appendChild(tableWrap);

        accordion.appendChild(header);
        accordion.appendChild(content);
        main.appendChild(accordion);
      });
    }

    // Fetch data dari API dan group by liga
    async function fetchAndRenderLeagues(sportKey) {
      showLoader();
      try {
        const res = await fetch(URL_API + '?sport=' + encodeURIComponent(sportKey));
        if (!res.ok) throw new Error('Gagal fetch');
        const jadwal = await res.json();

        // Group by liga
        const ligaMap = {};
        if (sportKey === 'esport') {
          // Gabung game + turnamen jadi nama liga
          jadwal.forEach(j => {
            if (!j.game || !j.turnamen || !j.tanggal || !j.jam || !j.tima || !j.timb || !j.linkbet) return;
            const ligaName = j.game + ' - ' + j.turnamen;
            if (!ligaMap[ligaName]) ligaMap[ligaName] = [];
            ligaMap[ligaName].push(j);
          });
        } else {
          jadwal.forEach(j => {
            if (!j.liga || !j.tanggal || !j.jam || !j.home || !j.away || !j.linkbet) return;
            if (!ligaMap[j.liga]) ligaMap[j.liga] = [];
            ligaMap[j.liga].push(j);
          });
        }

        // Sort jadwal per liga by tanggal & jam
        Object.values(ligaMap).forEach(arr => {
          arr.sort((a, b) => {
            let tglA = (a.tanggal || '').replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$2-$1');
            let tglB = (b.tanggal || '').replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$2-$1');
            let dateA = new Date(tglA + ' ' + (a.jam || ''));
            let dateB = new Date(tglB + ' ' + (b.jam || ''));
            return dateA - dateB;
          });
        });

        renderLeagues(ligaMap, sportKey);
      } catch (e) {
        showError('Gagal mengambil data, silakan refresh.');
      }
    }

    // Dark mode toggle
    const darkToggleBtn = document.getElementById('dark-toggle');
    darkToggleBtn.onclick = function() {
      document.body.classList.toggle('dark-mode');
      darkToggleBtn.textContent = document.body.classList.contains('dark-mode') ? 'âï¸' : 'ð';
    };

    // Welcome screen logic
    const welcomeScreen = document.getElementById('welcome-screen');
    const container = document.querySelector('.container');
    const welcomeBtn = document.getElementById('welcome-btn');
    welcomeBtn.onclick = function() {
      welcomeScreen.style.opacity = '0';
      setTimeout(() => {
        welcomeScreen.style.display = 'none';
        container.style.display = 'block';
      }, 400);
    };

    // Inisialisasi jadwal sport (jadwal container tetap di-hide sampai welcome ditekan)
    window.currentSport = SPORTS[0].key;
    renderSportsTabs(window.currentSport);
    // Jadwal hanya tampil setelah welcome ditekan
    // fetchAndRenderLeagues(window.currentSport);

    // Setelah welcome, baru load jadwal
    welcomeBtn.addEventListener('click', function() {
      fetchAndRenderLeagues(window.currentSport);
    });

    // Touch support for accordion (optional, for mobile)
    document.addEventListener('touchstart', function(){}, {passive:true});
  </script>
</body>
</html>
