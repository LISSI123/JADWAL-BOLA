<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>JADWAL SPORT SLOTGOKIL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --bg-main: #fff;
      --bg-card: #fff;
      --bg-accent: #f1f3f6;
      --bg-hover: #e3eaf3;
      --border: #d1d5db;
      --text-main: #222;
      --text-muted: #666;
      --accent: #1976d2;
      --accent-dark: #135ba1;
      --bet-bg: #e3f0ff;
      --bet-hover: #bbdefb;
      --tab-bg: #f1f3f6;
      --tab-active: #fff;
      --tab-border: #d1d5db;
      --radius: 14px;
      --shadow: 0 2px 16px rgba(25, 118, 210, 0.07);
      --transition: cubic-bezier(.77,0,.18,1);
    }
    body {
      background: var(--bg-main);
      color: var(--text-main);
      font-family: 'Segoe UI', Arial, Roboto, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      transition: background 0.3s, color 0.3s;
    }
    /* Welcome Screen */
    #welcome-screen {
      position: fixed;
      z-index: 9999;
      top: 0; left: 0; right: 0; bottom: 0;
      background: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      transition: opacity 0.5s var(--transition);
    }
    .welcome-card {
      background: #fff;
      border-radius: 22px;
      box-shadow: 0 6px 32px rgba(25, 118, 210, 0.10), 0 1.5px 8px rgba(0,0,0,0.08);
      padding: 38px 32px 32px 32px;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 320px;
      max-width: 94vw;
      animation: fadeIn 0.7s var(--transition);
    }
    .welcome-logo {
      width: 180px;
      max-width: 80vw;
      margin-bottom: 28px;
      display: block;
    }
    .welcome-title {
      font-size: 2.1rem;
      font-weight: bold;
      color: var(--accent);
      text-align: center;
      margin-bottom: 28px;
      letter-spacing: 1px;
      font-family: 'Segoe UI', Arial, Roboto, sans-serif;
    }
    .welcome-btn {
      background: var(--accent);
      color: #fff;
      font-size: 1.25rem;
      font-weight: bold;
      border: none;
      border-radius: 12px;
      padding: 18px 38px;
      cursor: pointer;
      box-shadow: 0 2px 12px rgba(25,118,210,0.08);
      transition: background 0.2s, color 0.2s;
      margin-top: 12px;
      letter-spacing: 1px;
      text-align: center;
      outline: none;
    }
    .welcome-btn:hover, .welcome-btn:focus {
      background: var(--accent-dark);
      color: #fff;
    }
    @keyframes fadeIn {
      from { opacity: 0;}
      to { opacity: 1;}
    }
    /* Jadwal Container */
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 8px 32px 8px;
      display: none;
    }
    .header-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 0;
      padding: 18px 0 0 0;
    }
    .date-filter {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
      padding: 0 8px;
    }
    .date-filter label {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-main);
      white-space: nowrap;
    }
    .date-select {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-main);
      font-size: 1rem;
      font-weight: 500;
      padding: 8px 12px;
      cursor: pointer;
      outline: none;
      transition: border-color 0.2s, background 0.2s;
      min-width: 140px;
    }
    .date-select:focus {
      border-color: var(--accent);
      background: var(--bg-hover);
    }
    .date-select option {
      background: var(--bg-card);
      color: var(--text-main);
    }
    .sports-tabs {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      border-bottom: 1px solid var(--border);
      padding-bottom: 8px;
      margin: 0;
      flex: 1;
    }
    .sport-btn {
      background: var(--tab-bg);
      border: 1px solid var(--tab-border);
      border-bottom: none;
      border-radius: 7px 7px 0 0;
      color: var(--text-main);
      font-size: 1rem;
      font-weight: 500;
      padding: 8px 18px;
      cursor: pointer;
      outline: none;
      transition: background 0.2s, color 0.2s;
      min-width: 80px;
      white-space: nowrap;
    }
    .sport-btn.active {
      background: var(--tab-active);
      color: var(--accent);
      font-weight: 600;
      border-bottom: 2px solid var(--accent);
    }
    .dark-toggle-btn {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      margin-left: 12px;
      color: var(--text-muted);
      transition: color 0.2s;
    }
    .dark-toggle-btn:hover {
      color: var(--accent);
    }
    .accordion {
      margin-bottom: 18px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--bg-card);
      overflow: hidden;
      transition: background 0.3s, box-shadow 0.3s var(--transition);
      box-shadow: var(--shadow);
    }
    .accordion-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      padding: 14px 18px;
      background: var(--bg-accent);
      font-size: 1.08rem;
      font-weight: 600;
      border-bottom: 1px solid var(--border);
      user-select: none;
      transition: background 0.2s;
    }
    .accordion-header:hover, .accordion-header:active {
      background: var(--bg-hover);
    }
    .league-icon {
      font-size: 1.5rem;
      margin-right: 10px;
      flex-shrink: 0;
      display: inline-block;
      vertical-align: middle;
    }
    .accordion-title {
      font-weight: bold;
      color: var(--text-main);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .accordion-arrow {
      font-size: 1.2em;
      transition: transform 0.3s;
      margin-left: 10px;
      color: var(--text-muted);
    }
    .accordion.expanded .accordion-arrow {
      transform: rotate(90deg);
    }
    .accordion-content {
      max-height: 0;D
      overflow: hidden;
      transition: max-height 0.4s cubic-bezier(.4,0,.2,1), padding 0.3s;
      background: var(--bg-card);
      padding: 0 18px;
    }
    .accordion.expanded .accordion-content {
      padding: 14px 18px 18px 18px;
      max-height: none !important;
     overflow: visible !important;
    }
    .league-table-wrap {
      width: 100%;
      overflow-x: auto;
    }
    table.league-table {
      width: 100%;
      border-collapse: collapse;
      background: var(--bg-card);
      font-size: 0.98rem;
      min-width: 420px;
    }
    table.league-table th, table.league-table td {
      padding: 8px 6px;
      text-align: center;
      border-bottom: 1px solid var(--border);
      font-weight: 400;
      color: var(--text-main);
    }
    table.league-table th {
      background: var(--bg-accent);
      font-weight: 600;
      color: var(--text-muted);
      font-size: 0.97rem;
      letter-spacing: 0.5px;
    }
    table.league-table tr {
      background: var(--bg-card);
      transition: background 0.2s;
    }
    table.league-table tr:hover {
      background: var(--bg-hover);
    }
    .bet-btn {
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 4px;
      padding: 6px 16px;
      font-size: 0.97rem;
      font-weight: 700;
      cursor: pointer;
      text-decoration: none;
      transition: background 0.2s, color 0.2s;
      display: inline-block;
    }
    .bet-btn:hover, .bet-btn:focus {
      background: var(--accent-dark);
      color: #fff;
    }
    .error-msg {
      color: #d32f2f;
      background: #fff0f0;
      border: 1px solid #f5c2c7;
      border-radius: 6px;
      padding: 18px;
      text-align: center;
      margin: 32px 0;
      font-weight: 500;
    }
    .loader {
      text-align: center;
      color: var(--text-muted);
      padding: 32px 0;
      font-size: 1.1rem;
    }
    /* Dark mode */
    .dark-mode {
      --bg-main: #181a20;
      --bg-card: #23252b;
      --bg-accent: #23252b;
      --bg-hover: #222c36;
      --border: #333a45;
      --text-main: #fff;
      --text-muted: #b0b0b0;
      --accent: #90caf9;
      --accent-dark: #1976d2;
    }
    .dark-mode .error-msg {
      background: #2d1a1a;
      color: #ffb4b4;
      border-color: #a33;
    }
    .dark-mode .bet-btn {
      color: #fff;
      background: #1976d2;
    }
    .dark-mode .bet-btn:hover, .dark-mode .bet-btn:focus {
      background: #135ba1;
      color: #fff;
    }
    .dark-mode .date-select {
      background: var(--bg-card);
      color: var(--text-main);
      border-color: var(--border);
    }
    .dark-mode .date-select option {
      background: var(--bg-card);
      color: var(--text-main);
    }
    .dark-mode .accordion-title {
      color: var(--text-main);
    }
    .dark-mode .league-table th {
      color: var(--text-muted);
      background: var(--bg-accent);
    }
    .dark-mode .league-table td {
      color: var(--text-main);
    }
    @media (max-width: 700px) {
      .container { max-width: 100vw; padding: 0 2px 24px 2px; }
      .sports-tabs { font-size: 0.97rem; gap: 4px; }
      .sport-btn { padding: 7px 10px; font-size: 0.97rem; min-width: 60px; }
      .accordion-header { font-size: 1rem; padding: 11px 10px; }
      .accordion-content { padding: 0 10px; }
      .accordion.expanded .accordion-content { padding: 10px 10px 14px 10px; }
      table.league-table th, table.league-table td { 
        padding: 6px 2px; 
        font-size: 0.95rem; 
        word-wrap: break-word;
        max-width: 80px;
      }
      .bet-btn { padding: 5px 10px; font-size: 0.95rem; }
      .welcome-card { padding: 18px 8px 18px 8px; min-width: 0; }
      .welcome-logo { width: 120px; }
      .welcome-title { font-size: 1.1rem; margin-bottom: 18px; }
      .welcome-btn { font-size: 1rem; padding: 10px 18px; }
      .date-filter { 
        padding: 0 2px; 
        flex-wrap: wrap; 
        gap: 4px;
        justify-content: center;
      }
      .date-select { 
        min-width: 120px; 
        font-size: 0.95rem;
        flex: 1;
        max-width: 200px;
      }
      .league-table-wrap {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }
    }
    @media (max-width: 480px) {
      table.league-table { 
        min-width: 320px; 
        font-size: 0.93rem; 
      }
      .league-table-wrap { 
        padding: 0; 
        margin: 0 -10px;
      }
      table.league-table th, table.league-table td {
        padding: 4px 2px;
        font-size: 0.9rem;
        text-align: center;
      }
      .bet-btn {
        padding: 4px 8px;
        font-size: 0.85rem;
        min-width: 35px;
      }
      .date-filter {
        flex-direction: column;
        align-items: stretch;
        gap: 8px;
      }
      .date-filter label {
        text-align: center;
        font-size: 0.95rem;
      }
      .date-select {
        width: 100%;
        min-width: auto;
        max-width: none;
      }
    }
  </style>
</head>
<body>
  <div id="welcome-screen">
    <div class="welcome-card">
      <img class="welcome-logo" src="https://i.ibb.co/ksD92H7L/sg-logo-200x90-20211713191713-2.png" alt="Logo LDBPLAY">
      <div class="welcome-title">JADWAL SPORT SLOTGOKIL</div>
      <button class="welcome-btn" id="welcome-btn">LIHAT JADWAL SPORT</button>
    </div>
  </div>
  <div class="container">
    <div class="header-bar">
      <div class="sports-tabs" id="sports-tabs"></div>
      <button class="dark-toggle-btn" id="dark-toggle" title="Toggle dark mode">🌙</button>
    </div>
    <div class="date-filter">
      <label for="date-select">📅 Pilih Tanggal:</label>
      <select id="date-select" class="date-select">
        <option value="all">Semua Tanggal</option>
      </select>
    </div>
    <div id="main-content"></div>
  </div>
  <script>
    // Ganti URL_API sesuai endpoint Anda
    const URL_API = 'https://script.google.com/macros/s/AKfycbzoIifvsbqAcfiVvBhNdYsUqSGpu2AwpD2CntfeTseVk8rKatfOJ9pXCH0e4Ox1U1hU-A/exec';

    // Global variables untuk filter tanggal
    let allMatchesData = {};
    let currentSportData = null;
    let selectedDate = 'all';

    // Kategori olahraga + emoji
    const SPORTS = [
      { key: 'bola', label: 'Bola', emoji: '⚽' },
      { key: 'basket', label: 'Basket', emoji: '🏀' },
      { key: 'tennis', label: 'Tennis', emoji: '🎾' },
      { key: 'voli', label: 'Voli', emoji: '🏐' },
      { key: 'badminton', label: 'Badminton', emoji: '🏸' },
      { key: 'baseball', label: 'Baseball', emoji: '⚾' },
      { key: 'esport', label: 'Esports', emoji: '🎮' }
    ];

    // Mapping emoji bendera negara/turnamen (super lengkap)
    function getLigaIcon(liga) {
      if (!liga) return "🌍";
      const l = liga.toLowerCase();
      if (l.includes("afghanistan")) return "🇦🇫";
      if (l.includes("aland")) return "🇦🇽";
      if (l.includes("albania")) return "🇦🇱";
      if (l.includes("algeria")) return "🇩🇿";
      if (l.includes("american samoa")) return "🇦🇸";
      if (l.includes("andorra")) return "🇦🇩";
      if (l.includes("angola")) return "🇦🇴";
      if (l.includes("anguilla")) return "🇦🇮";
      if (l.includes("antarctica")) return "🇦🇶";
      if (l.includes("antigua") || l.includes("barbuda")) return "🇦🇬";
      if (l.includes("argentina")) return "🇦🇷";
      if (l.includes("armenia")) return "🇦🇲";
      if (l.includes("aruba")) return "🇦🇼";
      if (l.includes("australia")) return "🇦🇺";
      if (l.includes("austria")) return "🇦🇹";
      if (l.includes("azerbaijan")) return "🇦🇿";
      if (l.includes("bahamas")) return "🇧🇸";
      if (l.includes("bahrain")) return "🇧🇭";
      if (l.includes("bangladesh")) return "🇧🇩";
      if (l.includes("barbados")) return "🇧🇧";
      if (l.includes("belarus")) return "🇧🇾";
      if (l.includes("belgium")) return "🇧🇪";
      if (l.includes("belize")) return "🇧🇿";
      if (l.includes("benin")) return "🇧🇯";
      if (l.includes("bermuda")) return "🇧🇲";
      if (l.includes("bhutan")) return "🇧🇹";
      if (l.includes("bolivia")) return "🇧🇴";
      if (l.includes("bonaire")) return "🇧🇶";
      if (l.includes("bosnia")) return "🇧🇦";
      if (l.includes("botswana")) return "🇧🇼";
      if (l.includes("bouvet")) return "🇧🇻";
      if (l.includes("brazil")) return "🇧🇷";
      if (l.includes("british indian ocean territory")) return "🇮🇴";
      if (l.includes("brunei")) return "🇧🇳";
      if (l.includes("bulgaria")) return "🇧🇬";
      if (l.includes("burkina faso")) return "🇧🇫";
      if (l.includes("burundi")) return "🇧🇮";
      if (l.includes("cabo verde") || l.includes("cape verde")) return "🇨🇻";
      if (l.includes("cambodia")) return "🇰🇭";
      if (l.includes("cameroon")) return "🇨🇲";
      if (l.includes("canada")) return "🇨🇦";
      if (l.includes("cayman islands")) return "🇰🇾";
      if (l.includes("central african republic")) return "🇨🇫";
      if (l.includes("chad")) return "🇹🇩";
      if (l.includes("chile")) return "🇨🇱";
      if (l.includes("china")) return "🇨🇳";
      if (l.includes("christmas island")) return "🇨🇽";
      if (l.includes("cocos") || l.includes("keeling")) return "🇨🇨";
      if (l.includes("colombia")) return "🇨🇴";
      if (l.includes("comoros")) return "🇰🇲";
      if (l.includes("congo")) return "🇨🇬";
      if (l.includes("democratic republic of the congo") || l.includes("drc")) return "🇨🇩";
      if (l.includes("cook islands")) return "🇨🇰";
      if (l.includes("costa rica")) return "🇨🇷";
      if (l.includes("cote d'ivoire") || l.includes("ivory coast")) return "🇨🇮";
      if (l.includes("croatia")) return "🇭🇷";
      if (l.includes("cuba")) return "🇨🇺";
      if (l.includes("curaçao")) return "🇨🇼";
      if (l.includes("cyprus")) return "🇨🇾";
      if (l.includes("czech")) return "🇨🇿";
      if (l.includes("denmark")) return "🇩🇰";
      if (l.includes("djibouti")) return "🇩🇯";
      if (l.includes("dominica")) return "🇩🇲";
      if (l.includes("dominican republic")) return "🇩🇴";
      if (l.includes("ecuador")) return "🇪🇨";
      if (l.includes("egypt")) return "🇪🇬";
      if (l.includes("el salvador")) return "🇸🇻";
      if (l.includes("england")) return "🏴";
      if (l.includes("scotland")) return "🏴";
      if (l.includes("wales")) return "🏴";
      if (l.includes("northern ireland")) return "🇬🇧";
      if (l.includes("uk") || l.includes("united kingdom")) return "🇬🇧";
      if (l.includes("equatorial guinea")) return "🇬🇶";
      if (l.includes("eritrea")) return "🇪🇷";
      if (l.includes("estonia")) return "🇪🇪";
      if (l.includes("eswatini") || l.includes("swaziland")) return "🇸🇿";
      if (l.includes("ethiopia")) return "🇪🇹";
      if (l.includes("falkland islands")) return "🇫🇰";
      if (l.includes("faroe islands")) return "🇫🇴";
      if (l.includes("fiji")) return "🇫🇯";
      if (l.includes("finland")) return "🇫🇮";
      if (l.includes("france")) return "🇫🇷";
      if (l.includes("french guiana")) return "🇬🇫";
      if (l.includes("french polynesia")) return "🇵🇫";
      if (l.includes("french southern territories")) return "🇹🇫";
      if (l.includes("gabon")) return "🇬🇦";
      if (l.includes("gambia")) return "🇬🇲";
      if (l.includes("georgia")) return "🇬🇪";
      if (l.includes("germany")) return "🇩🇪";
      if (l.includes("ghana")) return "🇬🇭";
      if (l.includes("gibraltar")) return "🇬🇮";
      if (l.includes("greece")) return "🇬🇷";
      if (l.includes("greenland")) return "🇬🇱";
      if (l.includes("grenada")) return "🇬🇩";
      if (l.includes("guadeloupe")) return "🇬🇵";
      if (l.includes("guam")) return "🇬🇺";
      if (l.includes("guatemala")) return "🇬🇹";
      if (l.includes("guernsey")) return "🇬🇬";
      if (l.includes("guinea-bissau")) return "🇬🇼";
      if (l.includes("guinea")) return "🇬🇳";
      if (l.includes("guyana")) return "🇬🇾";
      if (l.includes("haiti")) return "🇭🇹";
      if (l.includes("heard island") || l.includes("mcdonald islands")) return "🇭🇲";
      if (l.includes("honduras")) return "🇭🇳";
      if (l.includes("hong kong")) return "🇭🇰";
      if (l.includes("hungary")) return "🇭🇺";
      if (l.includes("iceland")) return "🇮🇸";
      if (l.includes("india")) return "🇮🇳";
      if (l.includes("indonesia")) return "🇮🇩";
      if (l.includes("iran")) return "🇮🇷";
      if (l.includes("iraq")) return "🇮🇶";
      if (l.includes("ireland")) return "🇮🇪";
      if (l.includes("isle of man")) return "🇮🇲";
      if (l.includes("israel")) return "🇮🇱";
      if (l.includes("italy")) return "🇮🇹";
      if (l.includes("jamaica")) return "🇯🇲";
      if (l.includes("japan")) return "🇯🇵";
      if (l.includes("jersey")) return "🇯🇪";
      if (l.includes("jordan")) return "🇯🇴";
      if (l.includes("kazakhstan")) return "🇰🇿";
      if (l.includes("kenya")) return "🇰🇪";
      if (l.includes("kiribati")) return "🇰🇮";
      if (l.includes("north korea")) return "🇰🇵";
      if (l.includes("south korea") || l.includes("korea")) return "🇰🇷";
      if (l.includes("kuwait")) return "🇰🇼";
      if (l.includes("kyrgyzstan")) return "🇰🇬";
      if (l.includes("laos")) return "🇱🇦";
      if (l.includes("latvia")) return "🇱🇻";
      if (l.includes("lebanon")) return "🇱🇧";
      if (l.includes("lesotho")) return "🇱🇸";
      if (l.includes("liberia")) return "🇱🇷";
      if (l.includes("libya")) return "🇱🇾";
      if (l.includes("liechtenstein")) return "🇱🇮";
      if (l.includes("lithuania")) return "🇱🇹";
      if (l.includes("luxembourg")) return "🇱🇺";
      if (l.includes("macau")) return "🇲🇴";
      if (l.includes("madagascar")) return "🇲🇬";
      if (l.includes("malawi")) return "🇲🇼";
      if (l.includes("malaysia")) return "🇲🇾";
      if (l.includes("maldives")) return "🇲🇻";
      if (l.includes("mali")) return "🇲🇱";
      if (l.includes("malta")) return "🇲🇹";
      if (l.includes("marshall islands")) return "🇲🇭";
      if (l.includes("martinique")) return "🇲🇶";
      if (l.includes("mauritania")) return "🇲🇷";
      if (l.includes("mauritius")) return "🇲🇺";
      if (l.includes("mayotte")) return "🇾🇹";
      if (l.includes("mexico")) return "🇲🇽";
      if (l.includes("micronesia")) return "🇫🇲";
      if (l.includes("moldova")) return "🇲🇩";
      if (l.includes("monaco")) return "🇲🇨";
      if (l.includes("mongolia")) return "🇲🇳";
      if (l.includes("montenegro")) return "🇲🇪";
      if (l.includes("montserrat")) return "🇲🇸";
      if (l.includes("morocco")) return "🇲🇦";
      if (l.includes("mozambique")) return "🇲🇿";
      if (l.includes("myanmar") || l.includes("burma")) return "🇲🇲";
      if (l.includes("namibia")) return "🇳🇦";
      if (l.includes("nauru")) return "🇳🇷";
      if (l.includes("nepal")) return "🇳🇵";
      if (l.includes("netherlands")) return "🇳🇱";
      if (l.includes("new caledonia")) return "🇳🇨";
      if (l.includes("new zealand")) return "🇳🇿";
      if (l.includes("nicaragua")) return "🇳🇮";
      if (l.includes("niger")) return "🇳🇪";
      if (l.includes("nigeria")) return "🇳🇬";
      if (l.includes("niue")) return "🇳🇺";
      if (l.includes("norfolk island")) return "🇳🇫";
      if (l.includes("north macedonia")) return "🇲🇰";
      if (l.includes("northern mariana islands")) return "🇲🇵";
      if (l.includes("norway")) return "🇳🇴";
      if (l.includes("oman")) return "🇴🇲";
      if (l.includes("pakistan")) return "🇵🇰";
      if (l.includes("palau")) return "🇵🇼";
      if (l.includes("palestine")) return "🇵🇸";
      if (l.includes("panama")) return "🇵🇦";
      if (l.includes("papua new guinea")) return "🇵🇬";
      if (l.includes("paraguay")) return "🇵🇾";
      if (l.includes("peru")) return "🇵🇪";
      if (l.includes("philippines")) return "🇵🇭";
      if (l.includes("pitcairn")) return "🇵🇳";
      if (l.includes("poland")) return "🇵🇱";
      if (l.includes("portugal")) return "🇵🇹";
      if (l.includes("puerto rico")) return "🇵🇷";
      if (l.includes("qatar")) return "🇶🇦";
      if (l.includes("reunion")) return "🇷🇪";
      if (l.includes("romania")) return "🇷🇴";
      if (l.includes("russia")) return "🇷🇺";
      if (l.includes("rwanda")) return "🇷🇼";
      if (l.includes("saint barthelemy")) return "🇧🇱";
      if (l.includes("saint helena")) return "🇸🇭";
      if (l.includes("saint kitts") || l.includes("nevis")) return "🇰🇳";
      if (l.includes("saint lucia")) return "🇱🇨";
      if (l.includes("saint martin")) return "🇲🇫";
      if (l.includes("saint pierre") || l.includes("miquelon")) return "🇵🇲";
      if (l.includes("saint vincent") || l.includes("grenadines")) return "🇻🇨";
      if (l.includes("samoa")) return "🇼🇸";
      if (l.includes("san marino")) return "🇸🇲";
      if (l.includes("sao tome") || l.includes("principe")) return "🇸🇹";
      if (l.includes("saudi arabia")) return "🇸🇦";
      if (l.includes("senegal")) return "🇸🇳";
      if (l.includes("serbia")) return "🇷🇸";
      if (l.includes("seychelles")) return "🇸🇨";
      if (l.includes("sierra leone")) return "🇸🇱";
      if (l.includes("singapore")) return "🇸🇬";
      if (l.includes("sint maarten")) return "🇸🇽";
      if (l.includes("slovakia")) return "🇸🇰";
      if (l.includes("slovenia")) return "🇸🇮";
      if (l.includes("solomon islands")) return "🇸🇧";
      if (l.includes("somalia")) return "🇸🇴";
      if (l.includes("south africa")) return "🇿🇦";
      if (l.includes("south georgia") || l.includes("south sandwich")) return "🇬🇸";
      if (l.includes("south sudan")) return "🇸🇸";
      if (l.includes("spain")) return "🇪🇸";
      if (l.includes("sri lanka")) return "🇱🇰";
      if (l.includes("sudan")) return "🇸🇩";
      if (l.includes("suriname")) return "🇸🇷";
      if (l.includes("svalbard") || l.includes("jan mayen")) return "🇸🇯";
      if (l.includes("sweden")) return "🇸🇪";
      if (l.includes("switzerland")) return "🇨🇭";
      if (l.includes("syria")) return "🇸🇾";
      if (l.includes("taiwan")) return "🇹🇼";
      if (l.includes("tajikistan")) return "🇹🇯";
      if (l.includes("tanzania")) return "🇹🇿";
      if (l.includes("thailand")) return "🇹🇭";
      if (l.includes("timor-leste") || l.includes("east timor")) return "🇹🇱";
      if (l.includes("togo")) return "🇹🇬";
      if (l.includes("tokelau")) return "🇹🇰";
      if (l.includes("tonga")) return "🇹🇴";
      if (l.includes("trinidad") || l.includes("tobago")) return "🇹🇹";
      if (l.includes("tunisia")) return "🇹🇳";
      if (l.includes("turkey")) return "🇹🇷";
      if (l.includes("turkmenistan")) return "🇹🇲";
      if (l.includes("turks") || l.includes("caicos")) return "🇹🇨";
      if (l.includes("tuvalu")) return "🇹🇻";
      if (l.includes("uganda")) return "🇺🇬";
      if (l.includes("ukraine")) return "🇺🇦";
      if (l.includes("united arab emirates") || l.includes("uae")) return "🇦🇪";
      if (l.includes("united states") || l.includes("usa") || l.includes("mls")) return "🇺🇸";
      if (l.includes("uruguay")) return "🇺🇾";
      if (l.includes("uzbekistan")) return "🇺🇿";
      if (l.includes("vanuatu")) return "🇻🇺";
      if (l.includes("vatican")) return "🇻🇦";
      if (l.includes("venezuela")) return "🇻🇪";
      if (l.includes("vietnam")) return "🇻🇳";
      if (l.includes("virgin islands")) return "🇻🇮";
      if (l.includes("wallis") || l.includes("futuna")) return "🇼🇫";
      if (l.includes("western sahara")) return "🇪🇭";
      if (l.includes("yemen")) return "🇾🇪";
      if (l.includes("zambia")) return "🇿🇲";
      if (l.includes("zimbabwe")) return "🇿🇼";
      // ASEAN, AFF, CAF, UEFA, CONMEBOL, CONCACAF, OFC, CAF, dst
      if (l.includes("asean") || l.includes("aff") || l.includes("caf") || l.includes("uefa") || l.includes("conmebol") || l.includes("concacaf") || l.includes("ofc")) return "🌍";
      return "🌍";
    }

    // Render tabs kategori olahraga
    function renderSportsTabs(activeSport) {
      const tabs = document.getElementById('sports-tabs');
      tabs.innerHTML = '';
      SPORTS.forEach(sport => {
        const btn = document.createElement('button');
        btn.className = 'sport-btn' + (sport.key === activeSport ? ' active' : '');
        btn.textContent = sport.emoji + ' ' + sport.label;
        btn.onclick = () => {
          if (window.currentSport !== sport.key) {
            window.currentSport = sport.key;
            renderSportsTabs(sport.key);
            fetchAndRenderLeagues(sport.key);
          }
        };
        tabs.appendChild(btn);
      });
    }

    // Loader
    function showLoader() {
      document.getElementById('main-content').innerHTML =
        '<div class="loader">Memuat jadwal...</div>';
    }

    // Error
    function showError(msg) {
      document.getElementById('main-content').innerHTML =
        `<div class="error-msg">${msg}</div>`;
    }

    // Get today's date in DD/MM/YYYY format
    function getTodayDate() {
      const today = new Date();
      const day = String(today.getDate()).padStart(2, '0');
      const month = String(today.getMonth() + 1).padStart(2, '0');
      const year = today.getFullYear();
      return `${day}/${month}/${year}`;
    }

    // Populate date select options
    function populateDateOptions(leagues) {
      const dateSelect = document.getElementById('date-select');
      const dates = new Set();
      
      // Collect all unique dates
      Object.values(leagues).forEach(matches => {
        matches.forEach(match => {
          if (match.tanggal) {
            dates.add(match.tanggal);
          }
        });
      });
      
      // Sort dates
      const sortedDates = Array.from(dates).sort((a, b) => {
        let dateA = a.replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$2-$1');
        let dateB = b.replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$2-$1');
        return new Date(dateA) - new Date(dateB);
      });
      
      // Clear existing options except "Semua Tanggal"
      dateSelect.innerHTML = '<option value="all">Semua Tanggal</option>';
      
      // Get today's date
      const today = getTodayDate();
      let todayExists = false;
      
      // Add date options
      sortedDates.forEach(date => {
        const option = document.createElement('option');
        option.value = date;
        option.textContent = date;
        
        // Check if this is today's date
        if (date === today) {
          todayExists = true;
          option.textContent = date + ' (Hari Ini)';
          option.style.fontWeight = 'bold';
          option.style.color = '#1976d2';
        }
        
        if (date === selectedDate) {
          option.selected = true;
        }
        dateSelect.appendChild(option);
      });
      
      // Auto-select today's date if it exists and no date is currently selected
      if (todayExists && selectedDate === 'all') {
        selectedDate = today;
        dateSelect.value = today;
      }
    }

    // Filter leagues by selected date
    function filterLeaguesByDate(leagues, targetDate) {
      if (targetDate === 'all') {
        return leagues;
      }
      
      const filtered = {};
      Object.entries(leagues).forEach(([league, matches]) => {
        const filteredMatches = matches.filter(match => match.tanggal === targetDate);
        if (filteredMatches.length > 0) {
          filtered[league] = filteredMatches;
        }
      });
      
      return filtered;
    }

    // Render liga dan pertandingan
    function renderLeagues(leagues, sportKey) {
      const main = document.getElementById('main-content');
      main.innerHTML = '';
      
      // Store original data
      currentSportData = leagues;
      
      // Populate date options
      populateDateOptions(leagues);
      
      // Filter by selected date
      const filteredLeagues = filterLeaguesByDate(leagues, selectedDate);
      
      if (!filteredLeagues || Object.keys(filteredLeagues).length === 0) {
        main.innerHTML = '<div class="error-msg">Tidak ada jadwal tersedia untuk tanggal yang dipilih.</div>';
        return;
      }
      Object.entries(filteredLeagues).forEach(([league, matches], idx) => {
        // Accordion
        const accordion = document.createElement('div');
        accordion.className = 'accordion' + (idx === 0 ? ' expanded' : '');

        // Header
        const header = document.createElement('div');
        header.className = 'accordion-header';
        header.innerHTML = `
          <span class="accordion-title">
            <span class="league-icon">${getLigaIcon(league)}</span>
            ${escapeHTML(league)}
          </span>
          <span class="accordion-arrow">&#9654;</span>`;
        header.onclick = () => {
          accordion.classList.toggle('expanded');
        };

        // Content
        const content = document.createElement('div');
        content.className = 'accordion-content';

        // Table
        const tableWrap = document.createElement('div');
        tableWrap.className = 'league-table-wrap';
        const table = document.createElement('table');
        table.className = 'league-table';
        table.innerHTML = `
          <thead>
            <tr>
              <th>Tanggal</th>
              <th>Jam</th>
              <th>Home</th>
              <th>Away</th>
              <th>BET</th>
            </tr>
          </thead>
          <tbody>
            ${matches.map(m => `
              <tr>
                <td>${escapeHTML(m.tanggal || '')}</td>
                <td>${escapeHTML(m.jam || '')}</td>
                <td>${escapeHTML(m.home || m.tima || '')}</td>
                <td>${escapeHTML(m.away || m.timb || '')}</td>
                <td>
                  <a class="bet-btn" href="${m.linkbet || '#'}" target="_blank" rel="noopener">BET</a>
                </td>
              </tr>
            `).join('')}
          </tbody>
        `;
        tableWrap.appendChild(table);
        content.appendChild(tableWrap);

        accordion.appendChild(header);
        accordion.appendChild(content);
        main.appendChild(accordion);
      });
    }

    // Escape HTML for safety
    function escapeHTML(str) {
      return String(str || '').replace(/[&<>"']/g, function(m) {
        return ({'&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'})[m];
      });
    }

    // Fetch data dari API dan group by liga
    async function fetchAndRenderLeagues(sport) {
      showLoader();
      try {
        const res = await fetch(URL_API + '?sport=' + encodeURIComponent(sport));
        if (!res.ok) throw new Error('Gagal fetch');
        const jadwal = await res.json();

        // Group by liga
        const ligaMap = {};
        if (sport === 'esport') {
          jadwal.forEach(j => {
            if (!j.game || !j.turnamen || !j.tanggal || !j.jam || !j.tima || !j.timb || !j.linkbet) return;
            const ligaName = j.game + ' - ' + j.turnamen;
            if (!ligaMap[ligaName]) ligaMap[ligaName] = [];
            ligaMap[ligaName].push(j);
          });
        } else {
          jadwal.forEach(j => {
            if (!j.liga || !j.tanggal || !j.jam || !(j.home || j.tima) || !(j.away || j.timb) || !j.linkbet) return;
            if (!ligaMap[j.liga]) ligaMap[j.liga] = [];
            ligaMap[j.liga].push(j);
          });
        }

        // Sort jadwal per liga by tanggal & jam
        Object.values(ligaMap).forEach(arr => {
          arr.sort((a, b) => {
            let tglA = (a.tanggal || '').replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$2-$1');
            let tglB = (b.tanggal || '').replace(/(\d{2})\/(\d{2})\/(\d{4})/, '$3-$2-$1');
            let dateA = new Date(tglA + ' ' + (a.jam || ''));
            let dateB = new Date(tglB + ' ' + (b.jam || ''));
            return dateA - dateB;
          });
        });

        renderLeagues(ligaMap, sport);
      } catch (e) {
        showError('Gagal mengambil data, silakan refresh.');
      }
    }

    // Date filter event listener
    document.getElementById('date-select').addEventListener('change', function() {
      selectedDate = this.value;
      if (currentSportData) {
        renderLeagues(currentSportData, window.currentSport);
      }
    });

    // Dark mode toggle
    const darkToggleBtn = document.getElementById('dark-toggle');
    darkToggleBtn.onclick = function() {
      document.body.classList.toggle('dark-mode');
      darkToggleBtn.textContent = document.body.classList.contains('dark-mode') ? '☀️' : '🌙';
    };

    // Welcome screen logic
    const welcomeScreen = document.getElementById('welcome-screen');
    const container = document.querySelector('.container');
    const welcomeBtn = document.getElementById('welcome-btn');
    welcomeBtn.onclick = function() {
      welcomeScreen.style.opacity = '0';
      setTimeout(() => {
        welcomeScreen.style.display = 'none';
        container.style.display = 'block';
      }, 400);
      window.currentSport = SPORTS[0].key;
      renderSportsTabs(window.currentSport);
      fetchAndRenderLeagues(window.currentSport);
    };

    // Touch support for accordion (optional, for mobile)
    document.addEventListener('touchstart', function(){}, {passive:true});
  </script>
</body>
</html>
